<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Organograma Engemon</title>

  <!-- ====== IMPORTAÇÕES EXTERNAS ====== -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>

  <!-- ====== HEADER ====== -->
  <header class="hero-bg py-12 shadow-lg text-center">
    <h1 class="text-5xl font-extrabold drop-shadow-md" style="color:var(--header-text);">
      Organograma <span style="color:#00AEEF">Engemon</span>
    </h1>
    <p class="mt-3 text-lg font-medium" style="color:var(--header-text);">Estrutura organizacional da Engemon</p>

    <!-- Visual theme switch -->
    <div class="theme-switch" aria-hidden="false">
      <span class="label" style="color:var(--header-text);">Tema</span>
      <label class="switch" title="Alternar tema">
        <input id="toggleThemeSwitch" type="checkbox" aria-label="Alternar tema claro/escuro">
        <span class="slider"></span>
      </label>
    </div>
  </header>

  <!-- ====== MAIN: FILTROS + CHART ====== -->
  <main class="p-6 space-y-6">

    <!-- ==== FILTROS ==== -->
    <div id="filtersPanel" class="flex flex-wrap items-end gap-4 filters-panel p-4 rounded-lg shadow">
      <div class="flex flex-col">
        <label for="departamento" class="font-semibold text-sm mb-1">Departamento:</label>
        <div id="departamento-container" class="relative w-56">
          <input id="departamento" autocomplete="off" type="text"
            class="border rounded-lg px-3 py-2 w-full focus:ring-2 focus:ring-blue-400 outline-none"
            placeholder="Filtrar departamento..." />
          <div id="departamento-list" class="autocomplete-list hidden"></div>
        </div>
      </div>
      <button id="btnFiltrar" class="btn-primary">Filtrar</button>

      <div class="flex flex-col">
        <label for="buscaColaborador" class="font-semibold text-sm mb-1">Colaborador:</label>
        <div id="colaborador-container" class="relative w-56">
          <input id="buscaColaborador" autocomplete="off" type="text"
            placeholder="Buscar colaborador..."
            class="border rounded-lg px-3 py-2 w-full focus:ring-2 focus:ring-blue-400 outline-none" />
          <div id="colaborador-list" class="autocomplete-list hidden"></div>
        </div>
      </div>
      <button id="btnIrColaborador" class="btn-primary">Ir para colaborador</button>

      <div class="relative inline-block">
        <button id="btnCamera" class="btn-primary flex items-center gap-2">📸 Exportar</button>

        <div id="cameraDropdown" class="absolute hidden mt-2 w-64 border rounded-lg shadow-lg z-50 p-2">
          <div class="mb-2">
            <button id="exportVisible" class="block w-full px-3 py-2 text-left hover:bg-gray-100 rounded">Exportar área visível</button>
            <button id="exportCrop" class="block w-full px-3 py-2 text-left hover:bg-gray-100 rounded mt-1">Selecionar recorte</button>
          </div>

          <div class="border-t pt-2 mt-2">
            <label class="block text-xs font-medium mb-1">Background</label>
            <select id="exportBackground" class="w-full border rounded px-2 py-1">
              <option value="white">Branco</option>
              <option value="transparent">Transparente</option>
              <option value="brand">Azul Engemon</option>
            </select>
          </div>

          <div class="border-t pt-2 mt-2">
            <label class="block text-xs font-medium mb-1">Qualidade (DPI)</label>
            <select id="exportScale" class="w-full border rounded px-2 py-1">
              <option value="1">1x (padrão)</option>
              <option value="2">2x (melhor)</option>
              <option value="3">3x (alta)</option>
            </select>
          </div>
        </div>
      </div>

      <div class="flex items-center gap-2 ml-auto">
        <button id="zoomIn" title="Aumentar zoom" class="btn-primary">+</button>
        <button id="zoomOut" title="Diminuir zoom" class="btn-primary">–</button>
        <button id="resetZoom" title="Resetar zoom" class="btn-primary" style="background:gray;">⟳</button>
      </div>
    </div>

    <!-- ==== ÁREA DO ORGANOGRAMA ==== -->
    <div id="orgWrapper" class="relative inline-block w-full">
      <div id="orgContainer" class="org-container p-4">
        <div id="chart"></div>
      </div>
    </div>
  </main>

  <!-- ====== FOOTER ====== -->
  <footer class="modern-footer" role="contentinfo" aria-label="Rodapé Engemon Organograma">
    <div class="footer-inner">
      <div class="brand" aria-hidden="true">
        <div class="logo" aria-hidden="true">
          <!-- decorative logo: letter E -->
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="0" y="0" width="24" height="24" rx="5" fill="url(#lg)"/>
            <defs>
              <linearGradient id="lg" x1="0" x2="1">
                <stop offset="0" stop-color="#0077C8"/>
                <stop offset="1" stop-color="#00AEEF"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div>
          <div class="site-name">Engemon Organograma</div>
          <div class="site-tag">Design moderno • Acessível</div>
        </div>
      </div>

      <div class="actions" aria-label="Ações de contato">
        <!-- Link de Feedback -->
        <a class="action feedback"
           href="mailto:gabriel.pereira@engemon.com.br?subject=Feedback%20-%20Organograma%20Engemon&body=Ol%C3%A1%20equipe%20Engemon%2C%0A%0AEstou%20enviando%20este%20feedback%20sobre%20o%20Organograma%20Engemon.%0A%0AP%C3%A1gina%2FSe%C3%A7%C3%A3o%3A%20%0ASugest%C3%A3o%2FComent%C3%A1rio%3A%20%0AImpacto%20esperado%3A%20%0A%0APassos%20(opcional)%3A%0A1)%20%0A2)%20%0A%0AObserva%C3%A7%C3%B5es%3A%20%0A%0AObrigado%2C%0A%5BSeu%20nome%5D"
           aria-label="Enviar feedback por e-mail">
          <span class="icon" aria-hidden="true">
            <!-- envelope icon -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 7.5v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-9"></path>
              <polyline points="22,7.5 12,13 2,7.5"></polyline>
            </svg>
          </span>
          <span class="label">
            Enviar feedback
            <small class="hint">Sugestões e elogios</small>
          </span>
        </a>

        <!-- Link de Reportar Erro -->
        <a class="action bug"
           href="mailto:gabriel.pereira@engemon.com.br?subject=Relato%20de%20Erro%20-%20Organograma%20Engemon&body=Ol%C3%A1%20equipe%20Engemon%2C%0A%0AQuero%20reportar%20um%20erro%20encontrado%20no%20Organograma%20Engemon.%0A%0AURL%2FSe%C3%A7%C3%A3o%3A%20%0APassos%20para%20reproduzir%3A%0A1)%20%0A2)%20%0A%0AComportamento%20esperado%3A%20%0AComportamento%20observado%3A%20%0A%0ATempo%20%28data%2Fhora%29%3A%20%0ANavegador%2FSistema%20operacional%3A%20%0A%0AAnexar%20capturas%20de%20tela%20se%20poss%C3%ADvel.%0A%0AObrigado%2C%0A%5BSeu%20nome%5D"
           aria-label="Reportar erro por e-mail">
          <span class="icon" aria-hidden="true">
            <!-- bug icon -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 12h2"></path>
              <path d="M2 12h2"></path>
              <path d="M12 2v2"></path>
              <path d="M12 20v2"></path>
              <path d="M5 7l1.5 1.5"></path>
              <path d="M19 7l-1.5 1.5"></path>
              <path d="M5 17l1.5-1.5"></path>
              <path d="M19 17l-1.5-1.5"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </span>
          <span class="label">
            Reportar erro
            <small class="hint">Bugs e problemas</small>
          </span>
        </a>
      </div>
    </div>

    <div class="meta" aria-hidden="true">
      <span>© <span id="year"></span> Engemon Organograma — Feito com ♥</span>
      <span class="smallprint">Privacidade • Termos</span>
    </div>
  </footer>

  <!-- Export modal -->
  <div id="exportModal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="rounded-lg shadow-lg w-80 text-center" style="background:var(--modal-bg); color:var(--modal-text); padding:16px;">
      <h3 class="text-lg font-semibold mb-4">Exportar captura</h3>
      <p class="mb-2">Escolha o formato para salvar:</p>
      <div class="flex justify-center gap-4">
        <button id="confirmPNG" class="btn-primary" style="background: #22c55e;">PNG</button>
        <button id="confirmPDF" class="btn-primary" style="background: #ef4444;">PDF</button>
      </div>

      <div class="modal-bottom">
        <button id="redoSelection" class="btn-primary" style="background:#f59e0b;">Refazer seleção</button>
        <button id="cancelExport" class="px-3 py-2 rounded-md" style="background:transparent; border:1px solid var(--dropdown-border); color:var(--modal-text);">Fechar</button>
      </div>
    </div>
  </div>
</body>
</html>
